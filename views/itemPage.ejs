<%- include('include/_header') -%>

<link rel="stylesheet" href="/css/itemPage.css" />

<style>
  .item-image {
    width: 100%;
    max-width: 500px; /* Increase the maximum width */
    height: auto;
  }
</style>

<div class="wrapper">
  <div class="image-container" style="position: relative; display: inline-block;">
    <img class="item-image" src="<%= item.image %>" id="primary-image" style="width: 100%; max-width: 1000px; height: auto;" />
    <img class="item-image" src="<%= item.imageAlt && item.imageAlt.trim() !== '' ? item.imageAlt : '/img/placeholder.png' %>" id="secondary-image" style="display: none; width: 100%; max-width: 1000px; height: auto;" />
    <button id="toggle-image" style="position: absolute; top: 50%; right: 0; transform: translateY(-50%);">&#9654;</button>
  </div>

  <div class="item-container">
    <div class="item-info">
      <div class="item-content">
        <h1><strong><%= item.name %></strong></h1>
        <p><strong>Price: $<%= item.price %></strong></p>
        <p><%= item.description %></p>

        <% if (item.sizes.placeholder === undefined) { %>
        <div class="size-selector">
          <label for="size">Type:</label>
          <select id="size" name="size">
            <% for (let size in item.sizes) { %>
            <option value="<%= size %>" data-quantity="<%= item.sizes[size] %>">
              <%= size %>
            </option>
            <% } %>
          </select>
          <% } %>
        </div>
      </div>

      <div class="item-actions">
        <div class="quantity-selector">
          <label for="quantity" id="quantity-label">Quantity:</label>
          <select id="quantity">
            <% for (let i = 1; i <= Math.min(10, item.sizes[0]); i++) { %>
            <option value="<%= i %>"><%= i %></option>
            <% } %>
          </select>
        </div>
        <input
          type="submit"
          id="add-to-cart"
          class="submit"
          value="Add to Cart"
        />
      </div>
    </div>
  </div>
</div>
<input type="hidden" id="itemId" value="<%= item.id %>" />
<input type="hidden" id="googleId" value="<%= session.user.googleId %>" />
<input type="hidden" id="placeholder" value="<%= item.sizes.placeholder%>" />

<script src="/js/itemPage.js"></script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const toggleImageButton = document.getElementById("toggle-image");
    const primaryImage = document.getElementById("primary-image");
    const secondaryImage = document.getElementById("secondary-image");

    if (!secondaryImage.src || secondaryImage.src.trim() === "") {
      toggleImageButton.style.display = "none"; // Hide button if no second image
      return;
    }

    toggleImageButton.addEventListener("click", () => {
      if (primaryImage.style.display === "none") {
        primaryImage.style.display = "block";
        secondaryImage.style.display = "none";
        toggleImageButton.textContent = "\u25B6"; // Right arrow
      } else {
        primaryImage.style.display = "none";
        secondaryImage.style.display = "block";
        toggleImageButton.textContent = "\u25C0"; // Left arrow
      }
    });
  });
</script>

<%- include('include/_footer') -%>
