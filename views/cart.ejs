<!-- include header -->
<%- include('include/_header') %>
<!-- /include header -->

<!-- Main Site -->

<main>
  <div class="wrapper">
    <h1>Cart</h1>
    <% let total = 0; %>
    <ul class="cart-list">
      <% for (let i = 0; i < cart.length; i++) { %>
      <li class="cart-item">
        <div
          class="cart-item-details"
          onclick="window.location.href='/item/' + '<%= cart[i].id %>'"
        >
          <h2><%= cart[i].name %></h2>
          <img src="<%= cart[i].image %>" alt="<%= cart[i].name %>" />
          <p><%= cart[i].description %></p>
          <% total += cart[i].price * cart[i].quantity; %>
          <p>Total: $<%= (cart[i].price * cart[i].quantity).toFixed(2) %></p>
        </div>
        <div class="cart-item-actions">
          <label for="quantity-<%= cart[i].id %>">Quantity:</label>
          <select
            id="quantity-<%= cart[i].id %>"
            class="quantity-dropdown"
            data-id="<%= cart[i].id %>"
          >
            <% for (let q = 0; q < Math.min(10, maxQuantity[i]) + 1; q++) { %>
            <option value="<%= q %>"><%= q %></option>
            <% } %>
          </select>
        </div>
      </li>
      <% } %>
    </ul>
    <% if (cart.length === 0) { %>
    <p>Your cart is currently empty.</p>
    <% } %>
    <div class="cart-summary">
      <h2>Total: $<%= total.toFixed(2) %></h2>
      <button id="checkout" class="checkout-button">Checkout</button>
    </div>
    <input type="hidden" id="warningOOS" value="<%= warnOOS %>" />
    <input type="hidden" id="warningQuant" value="<%= warnQuant %>" />
    <input type="hidden" id="googleId" value="<%= session.user.googleId %>" />
  </div>
</main>

<!-- /Main Site -->

<script src="/js/cart.js"></script>

<!-- include footer -->
<%- include('include/_footer') %>
<!-- /include footer -->
